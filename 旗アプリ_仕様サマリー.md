# 旗アプリ 仕様サマリー
> Claude Codeおよび新スレッドへの引き継ぎ用ドキュメント

---

## 1. アプリの概要

### 解決したい課題
県外から進学でこの地域にやってきた大学生が、地域のイベント・ボランティアに「一人で行くのが不安」で参加できないでいる。

### コンセプト
「不安を減らしながら、気持ちの合う人と一緒に地域に踏み出す」ための場所。単なるイベント情報アプリでも、マッチングアプリでもない。

### 目指す状態
- 気持ちの合う人と一緒にイベント・ボランティアに参加できる
- 知らない人でも「この人となら安心」と感じられる
- 地域のイベント情報が自然と集まっていて、探しやすい
- 参加を重ねるうちに、地域の人との繋がりが自然と育っていく

---

## 2. コアの仕組み：「旗」

「旗」とは、行きたいイベントがあるけど不安を感じている人が、一緒に行ってくれる仲間を募るための"ポスター"のようなもの。単なる「一緒に行く人募集」ではなく、**動機・フィーリングのマッチング**が核心。

### 旗に含まれる情報
- 誰が立てているか（ニックネーム・SNSリンク・参加履歴）
- 行きたいイベント・ボランティアの情報
- 何人で行きたいか（二人 / 三人 / 三人以上でワイワイ）  
  ※二人だと怖いと思う人もいるため三人以上の選択肢も残す
- 一緒に行きたい人の属性（同性のみ / こだわらない、大学生限定 / 社会人可、地域）
- 行きたい理由・気持ち ← **ここが一番大切**
- 集合場所・日時・締め切り

### 「旗」に手を挙げる人がいた場合のフロー
```
旗に手を挙げた人が出る（旗を立てた人に通知）
　↓
旗を立てた人が一緒に行くか決める
　↓（OKの場合）
旗に手を挙げた人が追記されて見えるようになる（手を挙げた人に通知）
　↓
旗の締め切りが来たら、旗を立てた人が一緒に行く人を選ぶ
　↓
当日集合
```

- アプリ上のやり取りはあえて機能としてしない（シンプルさ）
- 当日の連絡（遅刻など）はSNSを通じて直接行う（本人の判断）
- 締め切りが来たら、一緒に行けなかった人へは自動で定型文通知

### 「安心」を育てる仕組み
| 仕組み | 内容 |
|--------|------|
| SNSアカウント連携 | 普段の投稿・人となりが伝わる。過度な個人情報は不要 |
| 参加履歴の公開 | 旗を立てた・集った履歴。行動の積み重ねが信頼になる |
| 一緒に行った人からの評価（相互） | 実際に一緒に参加した人からの「安心度」評価が蓄積 |

---

## 3. システム構成

```
フロントエンド
  HTML + Tailwind CSS + 最小限のJavaScript
  Jinja2テンプレート（サーバーサイドレンダリング）

バックエンド
  FastAPI（Python）

データベース
  Supabase（PostgreSQL）
  ※ Supabase の Python クライアントで接続

デプロイ
  Render（無料枠あり、GitHubと連携して自動デプロイ）
```

---

## 4. Step 1 のスコープ

### 作るもの
- 旗の投稿（ステップ式フォーム）
- 旗の一覧・詳細表示
- 手を挙げる機能
- メール通知（手が挙がった・承認された）

### Step 1では作らないもの（後のステップで追加）
- アカウント登録・ログイン・SNS連携
- 評価機能
- イベント情報の自動収集
- チャット機能

### イベント情報の扱い（Step 1）
自動収集はまだないため、開発者が手動でDBにイベント情報を数件登録しておく。旗を立てる人はそのリストから選ぶ。

---

## 5. 画面一覧と画面遷移

### 画面一覧
| # | 画面名 |
|---|--------|
| 1 | トップページ |
| 2 | 旗を探す Step1：不安度を選ぶ |
| 3 | 旗を探す Step2：イベント種類と温度感を選ぶ |
| 4 | 旗一覧ページ |
| 5 | 旗詳細ページ |
| 6 | 旗を立てる Step1：イベントを選ぶ |
| 7 | 旗を立てる Step2：気持ち・温度感を入力 |
| 8 | 旗を立てる Step3：一緒に行きたい人の条件を選ぶ |
| 9 | 旗を立てる Step4：集合場所・日時・締め切りを入力 |
| 10 | 旗を立てる 確認画面 |
| 11 | 旗投稿完了ページ |
| 12 | 手を挙げた完了ページ |

### 旗を探す：画面遷移
```
トップページ
　↓「旗を探す」を選ぶ
Step1：不安度を選ぶ（初めてで不安 / 慣れている）
　↓
Step2：イベント種類と温度感を選ぶ
　　　 種類：ボランティア / 祭り・地域行事 / ワークショップ・体験
　　　 温度感：落ち着いて参加したい / ワイワイ参加したい
　↓
旗一覧ページ（条件に合った旗が並ぶ）
　↓ 気になる旗をタップ
旗詳細ページ
　↓「手を挙げる」ボタン
手を挙げた完了ページ
```

### 旗を立てる：画面遷移
```
トップページ
　↓「旗を立てる」を選ぶ
Step1：イベントを選ぶ（DBに登録済みのリストから選択）
　↓
Step2：気持ち・温度感を入力する（不安度・ワイワイ度・行きたい理由）
　↓
Step3：一緒に行きたい人の条件を選ぶ（人数・性別・属性・地域）
　↓
Step4：集合場所・日時・締め切りを入力する
　↓
確認画面（入力内容の確認）
　↓「投稿する」
旗投稿完了ページ
```

---

## 6. DB テーブル設計

### events テーブル（イベント情報）
| カラム名 | 型 | 内容 |
|---------|-----|------|
| id | UUID | 主キー |
| title | TEXT | イベント名 |
| description | TEXT | イベントの説明 |
| category | TEXT | 種類（ボランティア／祭り・地域行事／ワークショップ・体験） |
| location | TEXT | 場所・エリア |
| event_date | DATE | 開催日 |
| created_at | TIMESTAMP | 登録日時 |

※後のステップで追加予定：organizer、url、image_url、area

### flags テーブル（旗の情報）
| カラム名 | 型 | 内容 |
|---------|-----|------|
| id | UUID | 主キー |
| event_id | UUID | eventsテーブルへの参照 |
| nickname | TEXT | 旗を立てた人のニックネーム |
| anxiety_level | TEXT | 不安度（初めてで不安／慣れている） |
| vibe | TEXT | 温度感（落ち着いて／ワイワイ） |
| reason | TEXT | 行きたい理由・気持ち |
| group_size | TEXT | 人数（二人／三人／三人以上） |
| gender_pref | TEXT | 性別条件（同性のみ／こだわらない） |
| member_type | TEXT | 属性（大学生限定／社会人可） |
| meeting_place | TEXT | 集合場所 |
| meeting_time | TIMESTAMP | 集合日時 |
| deadline | DATE | 締め切り日 |
| status | TEXT | 状態（募集中／締切済） |
| created_at | TIMESTAMP | 投稿日時 |

---

## 7. 開発環境

### ローカル環境（Mac）
- Python 3.9.6
- Node.js v25.6.1
- Git 2.50.1
- Homebrew 4.6.18

### 開発の進め方
- このスレッド（Claude.ai）：仕様・方針・設計の決定、詰まったときの相談
- Claude Code（ターミナル）：ファイル生成・編集・コマンド実行・デバッグ

### コーディング開始時にやること
1. Claude Code のインストール（`npm install -g @anthropic-ai/claude-code`）
2. GitHub リポジトリの作成
3. プロジェクトフォルダの作成
4. 仮想環境の構築（`python3 -m venv venv`）
5. FastAPI・依存ライブラリのインストール
6. Supabase・Render のアカウント作成・連携

---

## 8. 段階的開発ロードマップ

| Step | 内容 |
|------|------|
| **Step 1（今回）** | 旗の投稿・一覧・詳細・手を挙げる・メール通知 |
| Step 2 | アカウント登録・SNS連携・プロフィール・旗の履歴 |
| Step 3 | 評価機能・マッチング後フローの整備 |
| Step 4 | イベント情報の自動収集・主催者投稿機能 |
| Step 5 | 体験の磨き込み・フィルタリング・通知改善 |
